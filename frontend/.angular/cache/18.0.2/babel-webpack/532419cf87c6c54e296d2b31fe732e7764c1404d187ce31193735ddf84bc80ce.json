{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.VulnerabilityComponent = void 0;\nconst i0 = require(\"@angular/core\");\nconst i1 = require(\"@angular/router\");\nconst i2 = require(\"../app.service\");\nconst i3 = require(\"../alert/alert.service\");\nconst i4 = require(\"@angular/common\");\nconst i5 = require(\"primeng/table\");\nconst i6 = require(\"primeng/api\");\nconst i7 = require(\"primeng/inputtext\");\nconst i8 = require(\"primeng/multiselect\");\nconst _c0 = [\"vulnTable\"];\nfunction VulnerabilityComponent_ng_template_3_ng_template_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"span\", 23);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const option_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(option_r5.name);\n  }\n}\nfunction VulnerabilityComponent_ng_template_3_ng_template_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"span\", 23);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const option_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(option_r6.name);\n  }\n}\nfunction VulnerabilityComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 8);\n    i0.ɵɵtext(2, \"Vulnerability ID\");\n    i0.ɵɵelement(3, \"p-sortIcon\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"th\", 10);\n    i0.ɵɵtext(5, \"Vulnerability Name\");\n    i0.ɵɵelement(6, \"p-sortIcon\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 12);\n    i0.ɵɵtext(8, \"Risk\");\n    i0.ɵɵelement(9, \"p-sortIcon\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 14);\n    i0.ɵɵtext(11, \"Systemic\");\n    i0.ɵɵelement(12, \"p-sortIcon\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\", 16);\n    i0.ɵɵtext(14, \"Jira URL\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\", 16);\n    i0.ɵɵtext(16, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\", 16);\n    i0.ɵɵtext(18, \"Actions\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"tr\")(20, \"th\")(21, \"input\", 17);\n    i0.ɵɵlistener(\"input\", function VulnerabilityComponent_ng_template_3_Template_input_input_21_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      i0.ɵɵnextContext();\n      const vulnTable_r3 = i0.ɵɵreference(2);\n      return i0.ɵɵresetView(vulnTable_r3.filter($event.target.value, \"id\", \"equals\"));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(22, \"th\")(23, \"input\", 18);\n    i0.ɵɵlistener(\"input\", function VulnerabilityComponent_ng_template_3_Template_input_input_23_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      i0.ɵɵnextContext();\n      const vulnTable_r3 = i0.ɵɵreference(2);\n      return i0.ɵɵresetView(vulnTable_r3.filter($event.target.value, \"name\", \"startsWith\"));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"th\")(25, \"p-multiSelect\", 19);\n    i0.ɵɵlistener(\"onChange\", function VulnerabilityComponent_ng_template_3_Template_p_multiSelect_onChange_25_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.onRiskChange($event));\n    });\n    i0.ɵɵtemplate(26, VulnerabilityComponent_ng_template_3_ng_template_26_Template, 3, 1, \"ng-template\", 20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(27, \"th\");\n    i0.ɵɵelementStart(28, \"th\")(29, \"input\", 21);\n    i0.ɵɵlistener(\"input\", function VulnerabilityComponent_ng_template_3_Template_input_input_29_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      i0.ɵɵnextContext();\n      const vulnTable_r3 = i0.ɵɵreference(2);\n      return i0.ɵɵresetView(vulnTable_r3.filter($event.target.value, \"jiraId\", \"contains\"));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(30, \"th\")(31, \"p-multiSelect\", 19);\n    i0.ɵɵlistener(\"onChange\", function VulnerabilityComponent_ng_template_3_Template_p_multiSelect_onChange_31_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.onStatusChange($event));\n    });\n    i0.ɵɵtemplate(32, VulnerabilityComponent_ng_template_3_ng_template_32_Template, 3, 1, \"ng-template\", 20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(33, \"th\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(25);\n    i0.ɵɵproperty(\"options\", ctx_r3.risks);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"options\", ctx_r3.statuses);\n  }\n}\nfunction VulnerabilityComponent_ng_template_4_i_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 30);\n  }\n}\nfunction VulnerabilityComponent_ng_template_4_i_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 31);\n  }\n}\nfunction VulnerabilityComponent_ng_template_4_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function VulnerabilityComponent_ng_template_4_button_18_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const vuln_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.deleteVuln(vuln_r8));\n    });\n    i0.ɵɵelement(1, \"i\", 33);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VulnerabilityComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 24);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"a\", 25);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\")(15, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function VulnerabilityComponent_ng_template_4_Template_button_click_15_listener() {\n      const vuln_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.navigateToVulnerabilityFormById(vuln_r8.id));\n    });\n    i0.ɵɵtemplate(16, VulnerabilityComponent_ng_template_4_i_16_Template, 1, 0, \"i\", 27)(17, VulnerabilityComponent_ng_template_4_i_17_Template, 1, 0, \"i\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(18, VulnerabilityComponent_ng_template_4_button_18_Template, 2, 0, \"button\", 29);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const vuln_r8 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.risk);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.systemic);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"href\", vuln_r8 == null ? null : vuln_r8.jiraId, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.jiraId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(vuln_r8 == null ? null : vuln_r8.status);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.readOnly);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.readOnly);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.readOnly);\n  }\n}\nfunction VulnerabilityComponent_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function VulnerabilityComponent_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.navigateToVulnerabilityForm());\n    });\n    i0.ɵɵtext(1, \" Create Vulnerability \");\n    i0.ɵɵelementEnd();\n  }\n}\nlet VulnerabilityComponent = /*#__PURE__*/(() => {\n  class VulnerabilityComponent {\n    constructor(activatedRoute, router, appService, alertService) {\n      this.activatedRoute = activatedRoute;\n      this.router = router;\n      this.appService = appService;\n      this.alertService = alertService;\n      this.vulnAry = [];\n      this.risks = [{\n        name: 'Informational'\n      }, {\n        name: 'Low'\n      }, {\n        name: 'Medium'\n      }, {\n        name: 'High'\n      }, {\n        name: 'Critical'\n      }];\n      this.statuses = [{\n        name: 'Open'\n      }, {\n        name: 'Resolved'\n      }, {\n        name: 'On Hold'\n      }];\n    }\n    ngOnInit() {\n      this.activatedRoute.data.subscribe(({\n        vulnerabilities\n      }) => {\n        this.vulnAry = vulnerabilities.vulnerabilities;\n        this.readOnly = vulnerabilities.readOnly;\n      });\n      this.activatedRoute.params.subscribe(params => {\n        this.assetId = params.assetId;\n        this.assessmentId = params.assessmentId;\n        this.orgId = params.orgId;\n      });\n    }\n    /**\n     * Function to navigate the user to the Vulnerability Form\n     * Takes no arguments, passes the org id, asset id, assessment id, and loads the form\n     */\n    navigateToVulnerabilityForm() {\n      this.router.navigate([`organization/${this.orgId}/asset/${this.assetId}/assessment/${this.assessmentId}/vuln-form`]);\n    }\n    /**\n     * Function responsible for navigating to a vulnerability\n     * @param vulnId is the ID of the vulnerability requested\n     */\n    navigateToVulnerabilityFormById(vulnId) {\n      this.router.navigate([`organization/${this.orgId}/asset/${this.assetId}/assessment/${this.assessmentId}/vuln-form/${vulnId}`]);\n    }\n    /**\n     * Function responsible for navigating to an assessment, takes no params directly\n     */\n    navigateToAssessments() {\n      this.router.navigate([`organization/${this.orgId}/asset/${this.assetId}`]);\n    }\n    /**\n     * Function responsible for navigating to report area, takes no params directly\n     */\n    navigateToReport() {\n      this.router.navigate([`organization/${this.orgId}/asset/${this.assetId}/assessment/${this.assessmentId}/report`]);\n    }\n    getVulnerabilities() {\n      this.appService.getVulnerabilities(this.assessmentId).subscribe(vulns => {\n        this.vulnAry = [];\n        this.vulnAry = vulns;\n      });\n    }\n    /**\n     * Function responsible for deleting a vulnerability\n     * @param vuln associated data for the vulnerability, cleans up associations\n     * of the vulnerability and the assessment it is assigned to by ID\n     */\n    deleteVuln(vuln) {\n      const r = confirm(`Delete the vulnerability \"${vuln.name}\"`);\n      if (r === true) {\n        this.appService.deleteVuln(vuln.id).subscribe(success => {\n          this.getVulnerabilities();\n          this.alertService.success(success);\n        });\n      }\n    }\n    onRiskChange(event) {\n      const selectedRiskAry = event.value.map(x => x.name);\n      this.table.filter(selectedRiskAry, 'risk', 'in');\n    }\n    onStatusChange(event) {\n      const selectedStatusAry = event.value.map(x => x.name);\n      this.table.filter(selectedStatusAry, 'status', 'in');\n    }\n    static #_ = this.ɵfac = function VulnerabilityComponent_Factory(t) {\n      return new (t || VulnerabilityComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.AppService), i0.ɵɵdirectiveInject(i3.AlertService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: VulnerabilityComponent,\n      selectors: [[\"app-vulnerability\"]],\n      viewQuery: function VulnerabilityComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.table = _t.first);\n        }\n      },\n      decls: 10,\n      vars: 4,\n      consts: [[\"vulnTable\", \"\"], [1, \"container-fluid\"], [\"styleClass\", \"p-datatable-striped\", 3, \"value\", \"paginator\", \"rows\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"type\", \"button\", \"class\", \"btn btn-primary float-right\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-info\", \"float-right\", 2, \"margin-right\", \"5px\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", \"float-right\", 2, \"margin-right\", \"5px\", 3, \"click\"], [\"pSortableColumn\", \"id\"], [\"field\", \"id\"], [\"pSortableColumn\", \"name\"], [\"field\", \"name\"], [\"pSortableColumn\", \"risk\"], [\"field\", \"risk\"], [\"pSortableColumn\", \"systemic\"], [\"field\", \"systemic\"], [\"scope\", \"col\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Search by ID\", 1, \"p-column-filter\", 3, \"input\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Search by Name\", 1, \"p-column-filter\", 3, \"input\"], [\"placeholder\", \"All\", \"optionLabel\", \"name\", \"styleClass\", \"p-column-filter\", 3, \"onChange\", \"options\"], [\"pTemplate\", \"item\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Search by Jira ID\", 1, \"p-column-filter\", 3, \"input\"], [1, \"p-multiselect-representative-option\"], [1, \"p-ml-1\"], [\"scope\", \"row\"], [\"target\", \"_blank\", 3, \"href\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 2, \"margin-right\", \"10px\", 3, \"click\"], [\"class\", \"pi pi-pencil\", 4, \"ngIf\"], [\"class\", \"pi pi-eye\", 4, \"ngIf\"], [\"class\", \"btn btn-dark\", \"type\", \"button\", 3, \"click\", 4, \"ngIf\"], [1, \"pi\", \"pi-pencil\"], [1, \"pi\", \"pi-eye\"], [\"type\", \"button\", 1, \"btn\", \"btn-dark\", 3, \"click\"], [1, \"pi\", \"pi-trash\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", \"float-right\", 3, \"click\"]],\n      template: function VulnerabilityComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"p-table\", 2, 0);\n          i0.ɵɵtemplate(3, VulnerabilityComponent_ng_template_3_Template, 34, 2, \"ng-template\", 3)(4, VulnerabilityComponent_ng_template_4_Template, 19, 10, \"ng-template\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(5, VulnerabilityComponent_button_5_Template, 2, 0, \"button\", 5);\n          i0.ɵɵelementStart(6, \"button\", 6);\n          i0.ɵɵlistener(\"click\", function VulnerabilityComponent_Template_button_click_6_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.navigateToReport());\n          });\n          i0.ɵɵtext(7, \" Preview Report \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"button\", 7);\n          i0.ɵɵlistener(\"click\", function VulnerabilityComponent_Template_button_click_8_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.navigateToAssessments());\n          });\n          i0.ɵɵtext(9, \" Back to Assessments \");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"value\", ctx.vulnAry)(\"paginator\", true)(\"rows\", 10);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", !ctx.readOnly);\n        }\n      },\n      dependencies: [i4.NgIf, i5.Table, i6.PrimeTemplate, i5.SortableColumn, i5.SortIcon, i7.InputText, i8.MultiSelect]\n    });\n  }\n  return VulnerabilityComponent;\n})();\nexports.VulnerabilityComponent = VulnerabilityComponent;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}